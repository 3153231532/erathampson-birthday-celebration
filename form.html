<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ğŸ Wish Chrispus & Contribute</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- FontAwesome -->
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
</head>
<body style="margin:0; padding:0; background: url('bd\ 99.avif') no-repeat center center fixed; background-size:cover; font-family:sans-serif; color:white;">

  <div style="background: rgba(0,0,0,0.6); margin: 20px auto; padding: 20px; border-radius: 12px; width: 90%; max-width: 400px;">
    <h2 style="text-align:center; color:gold;"><i class="fas fa-birthday-cake"></i> Wish Chrispus</h2>
    
    <!-- Name -->
    <label style="display:block; margin-top:10px;"><i class="fas fa-user" style="color:gold;"></i> Name</label>
    <input type="text" id="name" placeholder="Enter your name" style="width:100%; padding:8px; border:none; border-radius:6px; margin-top:4px;">
    
    <!-- Country -->
    <label style="display:block; margin-top:10px;"><i class="fas fa-globe" style="color:lightblue;"></i> Country</label>
    <select id="country" onchange="updateCountryData()" style="width:100%; padding:8px; border:none; border-radius:6px; margin-top:4px;">
      <option value="">-- Select Country --</option>
      <option value="ug">ğŸ‡ºğŸ‡¬ Uganda</option>
      <option value="ke">ğŸ‡°ğŸ‡ª Kenya</option>
      <option value="tz">ğŸ‡¹ğŸ‡¿ Tanzania</option>
      <option value="rw">ğŸ‡·ğŸ‡¼ Rwanda</option>
      <option value="bi">ğŸ‡§ğŸ‡® Burundi</option>
      <option value="ss">ğŸ‡¸ğŸ‡¸ South Sudan</option>
    </select>

    <!-- Phone -->
    <label style="display:block; margin-top:10px;"><i class="fas fa-phone-alt" style="color:lightgreen;"></i> Phone</label>
    <div id="codePrefix" style="margin-bottom:5px;">+XXX</div>
    <input type="text" id="phone" placeholder="Enter phone number" style="width:100%; padding:8px; border:none; border-radius:6px; margin-top:4px;">
    
    <!-- Residence -->
    <label style="display:block; margin-top:10px;"><i class="fas fa-home" style="color:orange;"></i> Current Residence</label>
    <input type="text" id="residence" placeholder="e.g. Kampala, Uganda" style="width:100%; padding:8px; border:none; border-radius:6px;">

    <!-- Do you want to contribute? -->
    <label style="margin-top:10px; display:block;">Would you like to contribute?</label>
    <label><input type="radio" name="contribute" value="yes" onclick="toggleAmount(true)"> Yes</label>
    <label><input type="radio" name="contribute" value="no" onclick="toggleAmount(false)" checked> No</label>

    <!-- Amount (hidden by default) -->
    <div id="amountSection" style="display:none; margin-top:10px;">
      <label><i class="fas fa-money-bill" style="color:lime;"></i> Amount (<span id="currency">Currency</span>)</label>
      <input type="number" id="amount" placeholder="Enter amount" style="width:100%; padding:8px; border:none; border-radius:6px;">
    </div>

    <!-- Comment -->
    <label style="display:block; margin-top:10px;"><i class="fas fa-comment" style="color:skyblue;"></i> Message</label>
    <textarea id="message" rows="3" placeholder="Your message to Chris..." style="width:100%; padding:8px; border:none; border-radius:6px;"></textarea>

    <!-- Payment Buttons -->
    <div id="paymentOptions" style="margin-top:15px;"></div>

    <!-- Submit -->
    <button onclick="submitForm()" style="margin-top:20px; width:100%; background:gold; color:black; padding:10px; font-weight:bold; border:none; border-radius:8px; cursor:pointer;">
      ğŸ Submit Wish
    </button>
  </div>

  <!-- Firebase Setup -->
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyD6ViagGfPE6Pb3Ml1J2xWHhjGx53WlNOo",
      authDomain: "birthdaycontributions.firebaseapp.com",
      databaseURL: "https://birthdaycontributions-default-rtdb.firebaseio.com",
      projectId: "birthdaycontributions",
      storageBucket: "birthdaycontributions.firebasestorage.app",
      messagingSenderId: "147686327811",
      appId: "1:147686327811:web:ceae1ecd8f56fadeff7036"
    };
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
  </script>

  <!-- Country Logic + Form Logic -->
  <script>
    const countryData = {
      ug: { code: "+256", currency: "UGX", mtn: "*165*1*1#", airtel: "*185*1#", networks: ["mtn", "airtel"] },
      ke: { code: "+254", currency: "KES", mtn: null, airtel: "*150*1#", networks: ["airtel"] },
      tz: { code: "+255", currency: "TZS", mtn: "*150*00#", airtel: "*150*60#", networks: ["mtn", "airtel"] },
      rw: { code: "+250", currency: "RWF", mtn: "*182#", airtel: null, networks: ["mtn"] },
      bi: { code: "+257", currency: "BIF", mtn: null, airtel: "*123#", networks: ["airtel"] },
      ss: { code: "+211", currency: "SSP", mtn: "*180#", airtel: "*182#", networks: ["mtn", "airtel"] }
    };

    function updateCountryData() {
      const selected = document.getElementById("country").value;
      const phoneCode = document.getElementById("codePrefix");
      const currencyLabel = document.getElementById("currency");
      const paymentOptions = document.getElementById("paymentOptions");

      if (!selected) return;

      const data = countryData[selected];
      phoneCode.innerText = data.code;
      currencyLabel.innerText = data.currency;

      // Reset and create buttons
      paymentOptions.innerHTML = "";
      if (data.networks.includes("mtn")) {
        const btn = document.createElement("button");
        btn.innerHTML = "Pay via MTN";
        btn.style = "width:100%; margin-top:10px; padding:10px; background:yellow; border:none; border-radius:6px; color:black; font-weight:bold; cursor:pointer;";
        btn.onclick = () => alert(`Dial ${data.mtn} then follow to send to +256780265508 (Adoko Chrispus)`);
        paymentOptions.appendChild(btn);
      }
      if (data.networks.includes("airtel")) {
        const btn = document.createElement("button");
        btn.innerHTML = "Pay via Airtel";
        btn.style = "width:100%; margin-top:10px; padding:10px; background:red; border:none; border-radius:6px; color:white; font-weight:bold; cursor:pointer;";
        btn.onclick = () => alert(`Dial ${data.airtel} then follow to send to +256741813093 (William Aheshibwe)`);
        paymentOptions.appendChild(btn);
      }
    }

    function toggleAmount(show) {
      document.getElementById("amountSection").style.display = show ? "block" : "none";
    }

    function submitForm() {
      const name = document.getElementById("name").value;
      const country = document.getElementById("country").value;
      const phone = document.getElementById("phone").value;
      const residence = document.getElementById("residence").value;
      const contribute = document.querySelector('input[name="contribute"]:checked').value;
      const amount = contribute === "yes" ? document.getElementById("amount").value : "0";
      const message = document.getElementById("message").value;

      if (!name || !country || !phone) {
        alert("Please fill all required fields.");
        return;
      }

      const ref = database.ref("wishers").push();
      ref.set({
        name, country, phone, residence, contribute, amount, message, status: contribute === "yes" ? "Pending" : "Not Paid"
      }).then(() => {
        window.location.href = "confirm.html?name=" + encodeURIComponent(name);
      });
    }
  </script>

  
</body>
</html>
